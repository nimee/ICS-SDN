<!DOCTYPE html>
<html>
    <head>
        <title>SDN IDS web UI</title>
        <link rel="stylesheet" href="static/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO">
        <script type="text/javascript" src="static/js/chart.js"></script>
        <script type="text/javascript" src="static/js/webui.js"></script>
        <style>
            .text-flameorange { color: #c75b12!important }
            .bg-flameorange { background-color: #c75b12!important }
            .text-ecogreen {color: #008542!important }
            .bg-ecogreen { background-color: #008542!important }
            .scrollable {
                max-height: 400px;
                overflow-y: scroll;
            }
        </style>
    </head>
    <body class="bg-ecogreen" onload="refreshAll(); setAutoRefresh(10000);" style="padding-top: 67px;">
        <div class="container-fluid">
            <nav class="navbar fixed-top bg-white">
                <a class="navbar-brand mr-auto" href="#">
                    <img src="static/img/header_ecs_orange_lo.png" height="40" hspace="5" alt="">
                </a>
                <div class="nav-itm mr-auto"><h4 class="text-flameorange">SDN IDS web ui</h4></div>
                <button id="btn-timer" class="btn btn-sm btn-outline-success"></button>
                <div class="nav-item ml-2" id="localtime"></div>
            </nav>
            <div class="card mt-1 mb-3" id="devcard">
                <div class="card-header bg-flameorange text-white">
                    <h4 class="card-title">OpenFlow devices</h4>
                </div>
                <div class="card-body">
                    <table class="table table-hover table-striped table-sm">
                        <thead class="thead-light">
                            <tr><th>Device ID</th><th>Available</th><th>Last update</th><th>Manufacturer</th><th>Hardware</th><th>Protocol</th><th>Configured role</th><th>Mirroring port</th></tr>
                        </thead>
                        <tbody id="devices"></tbody>
                    </table>
                    <a class="card-link" onclick="refreshDevices();" href="#devcard">Refresh</a>
                </div>
            </div>
            <div class="card mb-3" id="hstcard">
                <div class="card-header bg-flameorange text-white">
                    <h4 class="card-title">End-point hosts</h4>
                </div>
                <div class="card-body">
                    <table class="table table-hover table-striped table-sm">
                        <thead class="thead-light">
                            <tr><th>MAC address</th><th>IP addresses</th><th>Configured name</th><th>Locations</th><th>Configured role</th></tr>
                        </thead>
                        <tbody id="hosts"></tbody>
                    </table>
                    <a class="card-link" onclick="refreshHosts();" href="#hstcard">Refresh</a>
                </div>
            </div>
            <div class="card mb-3" id="ppscard">
                <div class="card-header bg-flameorange text-white">
                    <h4 class="card-title">Sniffed packets per second</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6" id="chpps"></div>
                        <div class="col-md-6">
                            <p class="lead text-ecogreen">Top 10 (Last 10 seconds)</p>
                            <table class="table table-striped table-sm">
                                <thead class="thead-light">
                                    <tr><th>#</th><th>Source</th><th>Destination</th><th>Protocol</th><th>Packets</th></tr>
                                </thead>
                                <tbody id="topsniffed"></tbody>
                            </table>
                        </div>
                    </div>
                    <a class="card-link" onclick="refreshPPSChart();" href="#ppscard">Refresh</a>
                </div>
            </div>
            <div class="card mb-3" id="grouping">
                <div class="card-header bg-flameorange text-white">
                    <h4 class="card-title">Device group management</h4>
                </div>
                <div class="card-body">
                    <div class="row mb-2">
                        <div class="col col-md-3 input-group">
                            <div class="input-group-prepend">
                                <div class="input-group-text">Device</div>
                            </div>
                            <select class="form-control" id="group-device" onchange="refreshGroups();"></select>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <div class="col">
                            <div class="lead text-ecogreen mt-2 mb-1">Create a new group</div>
                            <form>
                                <div class="form-row mb-2">
                                    <div class="col col-md-6 input-group">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text">Group ID</div>
                                        </div>
                                        <input type="text" class="form-control" id="newgroupid" placeholder="12345" pattern="[0-9]+" oninput="pcheck(this);">
                                    </div>
                                    <div class="col col-md-6 input-group">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text">appCookie</div>
                                        </div>
                                        <input type="text" class="form-control" id="newgroupappck" placeholder="0x1234abcd" pattern="0x[0-9a-fA-F]{8}" oninput="pcheck(this);">
                                    </div>
                                </div>
                                <div class="form-row text-ecogreen pl-3">Group buckets</div>
                                <div class="form-row mb-2">
                                    <div class="col col-md-4 input-group">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text">Type</div>
                                        </div>
                                        <select class="form-control" id="buckettype" onchange="updateBucketLabel();">
                                            <option value="OUTPUT" selected>OUTPUT</option>
                                            <option value="TABLE">TABLE</option>
                                            <option value="METER">METER</option>
                                        </select>
                                    </div>
                                    <div class="col col-md-4 input-group">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text" id="buckvallbl">Port</div>
                                        </div>
                                        <input type="text" class="form-control" id="bucketvalue" placeholder="123" pattern="[0-9]+" oninput="pcheck(this);">
                                    </div>
                                    <div class="col col-md-4 input-group">
                                        <div class="input-group-prepend w-50">
                                            <button type="button" class="btn btn-success w-100" onclick="addBucket();">Add bucket</button>
                                        </div>
                                        <div class="input-group-append w-50">
                                            <button type="button" class="btn btn-danger w-100" onclick="removeBucket();">Remove bucket</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="col col-md-12">
                                        <table class="table table-striped table-sm">
                                            <thead class="thead-light">
                                                <tr><th>Type</th><th>Value</th></tr>
                                            </thead>
                                            <tbody id="groupbuckets"></tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="col col-md-3">
                                        <button type="button" class="btn btn-success w-100" onclick="createGroup();">Create group</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="col">
                            <div class="lead text-ecogreen">Current groups</div>
                            <div class="table-responsive-md scrollable">
                                <table class="table table-striped table-sm">
                                    <thead class="thead-light">
                                        <tr>
                                            <th rowspan="2" style="vertical-align:middle; text-align: center;">Group ID</th>
                                            <th rowspan="2" style="vertical-align:middle; text-align: center;">appCookie</th>
                                            <th colspan="2" style="vertical-align:middle; text-align: center;">Buckets</th>
                                            <th rowspan="2" style="vertical-align:middle; text-align: center;">Manage</th>
                                        </tr>
                                        <tr>
                                            <th style="vertical-align:middle; text-align: center;">ID</th>
                                            <th style="vertical-align:middle; text-align: center;">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="device-groups"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <a class="card-link" onclick="refreshGroups();" href="#grouping">Refresh</a>
                </div>
            </div>
            <div class="card mb-3" id="flows">
                <div class="card-header bg-flameorange text-white">
                    <h4 class="card-title">Flow table management</h4>
                </div>
                <div class="card-body">
                    <div class="row mb-2">
                        <div class="col col-md-3 input-group">
                            <div class="input-group-prepend">
                                <div class="input-group-text">Device</div>
                            </div>
                            <select class="form-control" id="flows-device" onchange="refreshFlows();"></select>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <div class="col col-md-4">
                            <div class="lead text-ecogreen mb-2">Create a new flow</div>
                        </div>
                        <div class="col col-md-8">
                            <div class="lead text-ecogreen">Current flows</div>
                            <div class="table-responsive-md scrollable">
                                <table class="table table-hover table-striped table-sm">
                                    <thead class="thead-light">
                                        <tr>
                                            <th>ID</th>
                                            <th>State</th>
                                            <th>Priority</th>
                                            <th>Selector</th>
                                            <th>Treatment</th>
                                            <th>App name</th>
                                            <th>Manage</th>
                                        </tr>
                                    </thead>
                                    <tbody id="device-flows"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <a class="card-link" onclick="refreshFlows();" href="#flows">Refresh</a>
                </div>
            </div>
        </div>
    </body>
</html>